<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Virtual Revelation</title>
  <link rel="stylesheet" href="/assets/site.css" />
</head>
<body>
  <main class="shell">
    <header class="hero">
      <p class="eyebrow">Virtual Revelation</p>
      <h1>Deterministic worlds from a single stream of truth.</h1>
      <p class="lead">This is the public entry point for the Virtual-Revelation production suite. Choose a surface to explore or onboard a new user.</p>
      <div class="cta">
        <a class="button" href="/broker/">Open the Broker</a>
        <a class="button ghost" href="/graph/">View the Graph</a>
      </div>
    </header>

    <section class="grid">
      <a class="card" href="/canvas/">
        <h2>Canvas</h2>
        <p>Shared spatial surface with live transport fallback.</p>
      </a>
      <a class="card" href="/wiki/">
        <h2>Wiki</h2>
        <p>Append-only knowledge surface rendered from events.</p>
      </a>
      <a class="card" href="/forum/">
        <h2>Forum</h2>
        <p>Threaded discussions backed by the same event log.</p>
      </a>
      <a class="card" href="/scene/">
        <h2>Scene</h2>
        <p>3D or spatial projection surface (GLTF compatible).</p>
      </a>
    </section>

    <section class="stack">
      <div class="panel">
        <h3>Operational status</h3>
        <ul>
          <li>Broker: <code>/broker/</code></li>
          <li>WebSocket: <code>/ws</code> (if enabled)</li>
          <li>Artifacts: <code>/world/</code></li>
        </ul>
      </div>
      <div class="panel">
        <h3>Onboarding</h3>
        <p>New users should start with the broker and the wiki welcome page. See <a href="/docs/onboarding.html">Onboarding Guide</a>.</p>
      </div>
      <div class="panel">
        <h3>Install</h3>
        <p>Get a portable bundle via <a href="/install.sh">install.sh</a> or download <a href="/releases/tetragrammatron.tar.gz">tetragrammatron.tar.gz</a>.</p>
      </div>
      <div class="panel">
        <h3>Status</h3>
        <p>Live system health and artifact freshness: <a href="/status/">Status page</a>.</p>
        <p class="muted" id="statusStamp">Last update: loading</p>
      </div>
    </section>
  </main>
  <script>
    async function loadStatusStamp() {
      try {
        const res = await fetch('/status.json', { cache: 'no-store' });
        const data = await res.json();
        const stamp = data.last_world_build || 'unknown';
        document.getElementById('statusStamp').textContent = 'Last update: ' + stamp;
      } catch (err) {
        document.getElementById('statusStamp').textContent = 'Last update: unavailable';
      }
    }
    loadStatusStamp();
  </script>
</body>
</html>
